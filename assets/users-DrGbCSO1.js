import{j as e,D,a as U,b as w,c as R,B as x,r as a,t as u,u as v,R as E}from"./index-CK2oLD5z.js";import{C as L}from"./ConfirmDialog-oiENWVTv.js";import{I as _}from"./input-D_w0mAvW.js";import{S as I,a as T,b as k,c as z,d as A}from"./select-DpdcPHFh.js";function F({title:p,open:o,onOpenChange:i,onSave:d,loading:c=!1,error:l=null,children:m}){const t=async r=>{r.preventDefault(),await d()};return e.jsx(D,{open:o,onOpenChange:i,children:e.jsxs(U,{children:[e.jsx(w,{children:e.jsx(R,{children:p})}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[m,l&&e.jsx("div",{className:"text-sm text-destructive",children:l}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(x,{type:"submit",disabled:c,children:c?"Saving...":"Save Changes"})]})]})]})})}const J=function(){const[o,i]=a.useState([]),[d,c]=a.useState(!0),[l,m]=a.useState(null),[t,r]=a.useState(null),[f,g]=a.useState(null),[j,N]=a.useState({search:""});a.useEffect(()=>{y()},[]),a.useEffect(()=>{y()},[j]),a.useEffect(()=>{l&&u(l)},[l]);const y=async()=>{try{c(!0);const s=await v.getUsers({page:1,pageSize:100,...j});i(s.data),m(null)}catch{m("Failed to load users")}finally{c(!1)}},C=async()=>{try{u.error("This feature is not implemented yet")}catch{}},b=async(s,n)=>{try{await v.changeRole(s,n),i(S=>S.map(h=>h.id===s?{...h,role:n}:h)),u.success("User role updated successfully")}catch{u.error("Failed to update user role")}finally{r(null)}};return e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Users"})}),e.jsx("div",{className:"flex gap-4 mb-6",children:e.jsx(_,{className:"w-auto",placeholder:"Name | Email",onChange:s=>{N(n=>({...n,search:s.target.value}))}})}),d?e.jsx("p",{children:"Loading..."}):e.jsx("div",{className:"space-y-4",children:o.length>0?o.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.role[0].toUpperCase()+s.role.slice(1)," | Last online at",s.last_login_at?` ${new Date(s.last_login_at).toLocaleString("en-US",{month:"long",day:"numeric"})}`:" Never"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:s.email})]}),e.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Joined"," ",new Date(s.created_at).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!1})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:()=>r(s),children:"Change Role"}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>g(s),children:"Delete"})]})]})]},s.id)):e.jsx("p",{children:"No user found"})}),f&&e.jsx(L,{open:!!f,onOpenChange:s=>!s&&g(null),title:"Delete User",description:"Are you sure you want to delete? This action cannot be undone.",confirmLabel:"Delete",variant:"destructive",onConfirm:C}),t&&e.jsx(F,{title:"Change User Role",open:!!t,onOpenChange:s=>!s&&r(null),onSave:()=>b(t.id,t.role),loading:d,error:l,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Select a new role for ",t.name," (currently"," ",e.jsx("strong",{className:"text-red-500",children:t.role[0].toUpperCase()+t.role.slice(1)}),")"]}),e.jsxs(I,{onValueChange:s=>{if(!t)return;const n=s;n&&r({...t,role:n})},children:[e.jsx(T,{className:"w-full",children:e.jsx(k,{placeholder:"Select a role"})}),e.jsx(z,{children:E.map(s=>e.jsx(A,{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]})]})})]})};export{J as component};
